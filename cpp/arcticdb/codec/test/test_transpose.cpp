#include <gtest/gtest.h>

#include <arcticdb/codec/transpose.hpp>
#include <arcticdb/log/log.hpp>

#include <vector>

const uint64_t untransposed_arr_ow64[1024] =
    {0,1,1,2,4,5,9,9,11,12,13,14,14,18,19,19,20,21,21,23,25,26,26,27,28,32,33,34,35,35,36,37,37,39,40,40,42,44,44,45,45,48,50,52,54,55,56,57,57,57,60,60,61,61,62,62,63,63,63,63,64,66,66,68,69,69,71,71,71,72,73,75,78,79,81,82,83,85,85,85,86,92,93,95,96,96,97,99,100,101,103,104,105,106,107,108,108,113,113,114,115,116,117,117,118,121,122,122,122,123,126,126,128,130,130,131,131,132,133,133,133,136,137,137,140,142,142,143,143,144,145,146,148,148,148,149,150,150,152,154,154,155,156,159,160,161,164,164,164,168,170,170,171,172,172,173,173,177,177,178,178,179,181,181,183,184,184,186,189,190,190,190,192,197,198,199,199,200,200,200,201,201,202,202,203,206,208,210,210,211,212,213,213,215,215,215,216,217,218,219,220,220,221,222,223,223,225,227,228,230,230,231,233,233,235,235,235,236,239,240,240,242,242,243,247,249,250,251,251,251,252,254,255,257,260,261,261,261,261,262,262,263,263,264,264,264,267,267,268,269,269,270,271,272,274,275,275,275,276,276,277,278,278,280,280,282,284,285,285,285,286,286,289,290,290,290,291,292,293,294,295,296,296,297,297,298,300,302,302,303,303,305,306,306,306,307,309,310,310,310,312,313,314,316,317,317,320,320,321,322,323,324,326,328,331,331,336,336,336,336,336,337,340,342,342,343,344,344,345,345,347,347,347,348,348,350,351,354,354,354,356,357,357,357,360,361,362,363,364,364,365,365,367,367,369,370,371,372,372,373,373,376,376,377,378,378,378,379,379,379,380,380,380,381,381,382,382,384,385,386,388,388,390,391,392,392,393,393,394,394,396,397,398,398,399,401,401,402,402,403,407,408,408,408,409,409,410,410,412,413,414,414,415,416,416,416,418,419,419,420,422,423,424,424,425,425,427,428,429,432,434,435,435,436,436,438,438,439,439,440,442,442,443,445,448,449,451,451,452,452,453,456,457,457,457,458,458,459,459,461,461,463,464,466,467,468,468,468,468,469,469,470,472,472,473,474,475,477,478,478,479,479,480,481,481,484,484,486,486,487,487,488,489,491,492,492,493,494,495,498,498,499,500,502,502,503,504,505,505,506,506,508,510,510,511,511,511,514,515,515,519,521,522,523,523,523,527,527,529,530,534,534,535,537,538,538,538,539,539,539,539,541,542,542,543,545,545,545,546,547,548,548,549,555,556,557,557,559,559,560,560,560,562,564,564,566,572,573,573,574,575,576,577,582,582,584,584,584,587,588,589,590,594,594,595,596,596,598,598,599,600,600,601,606,606,608,608,608,608,610,610,611,611,613,613,613,615,616,616,616,617,617,617,618,619,619,623,624,627,628,630,631,631,632,632,633,633,633,635,635,635,636,636,636,638,639,639,642,643,650,650,653,653,654,655,655,657,657,657,658,660,660,661,662,662,663,664,664,664,665,665,665,666,668,669,671,672,673,673,675,677,678,679,680,681,682,682,682,683,684,685,685,686,689,689,689,689,690,691,691,692,692,693,693,693,698,699,700,702,702,703,703,704,704,704,705,708,710,712,713,713,715,718,719,721,724,724,725,727,727,728,728,730,730,733,733,734,737,737,738,738,738,739,740,740,741,741,741,742,745,746,746,746,748,748,749,750,751,753,754,755,755,757,757,758,759,761,762,762,764,765,766,768,770,772,772,773,775,776,776,777,777,779,779,779,781,782,782,782,783,783,785,786,787,788,788,788,791,792,794,794,795,796,796,800,800,801,804,805,805,808,809,810,812,813,815,815,816,816,817,818,818,819,820,822,824,825,825,826,827,828,828,828,828,829,829,829,830,830,830,831,832,832,834,834,837,838,838,840,840,841,844,844,845,846,848,848,849,849,850,850,851,852,852,853,856,857,858,860,861,861,861,862,863,864,865,868,868,869,869,870,871,872,872,873,873,874,875,875,876,878,878,878,878,880,882,885,885,885,885,886,887,889,892,892,893,894,894,895,896,896,896,897,898,898,898,899,901,902,902,903,905,905,907,907,907,908,908,909,911,911,911,913,913,914,915,915,915,915,915,915,916,918,918,920,921,922,922,923,928,929,929,932,933,933,934,934,934,935,935,935,935,936,937,937,938,939,941,941,943,943,944,945,946,946,947,947,947,952,953,956,957,957,957,959,959,959,960,961,961,962,962,963,963,963,964,965,967,967,968,970,971,973,976,978,978,978,982,983,983,985,985,985,985,986,987,987,987,989,990,991,991,992,992,992,993,994,995,996,996,998,998,999,999,};

const uint64_t transposed_arr_ow64[1024] =
    //	0		1		2		3		4		5		6		7		8		9		10		11		12		13		14		15		16		17		18		19		20		21		22		23		24		25		26		27		28		29		30		31		32		33		34		35		36		37		38		39		40		41		42		43		44		45		46		47		48		49		50		51		52		53		54		55		56		57		58		59		60		61		62		63		64		65		66		67		68		69		70		71		72		73		74		75		76		77		78		79		80		81		82		83		84		85		86		87		88		89		90		91		92		93		94		95		96		97		98		99		100		101		102		103		104		105		106		107		108		109		110		111		112		113		114		115		116		117		118		119		120		121		122		123		124		125		126		127
    {
        0,		69,		143,		213,		275,		336,		392,		452,		510,		584,		650,		704,		776,		832,		894,		943,		37,		108,		178,		247,		302,		367,		418,		479,		543,		616,		679,		741,		808,		864,		915,		973,		20,		86,		160,		228,		289,		351,		407,		467,		529,		601,		664,		728,		788,		849,		905,		959,		57,		128,		199,		262,		317,		379,		435,		493,		560,		632,		691,		757,		825,		878,		933,		989,		11,		78,		150,		220,		280,		345,		398,		458,		519,		595,		657,		718,		782,		841,		898,		952,		45,		118,		189,		255,		309,		373,		425,		486,		549,		623,		685,		748,		816,		872,		922,		985,		28,		100,		171,		235,		295,		360,		412,		472,		538,		610,		669,		737,		796,		857,		911,		963,		63,		133,		203,		268,		326,		382,		442,		502,		573,		636,		699,		765,		829,		885,		936,		994,
        1,		69,		144,		215,		275,		337,		392,		452,		510,		584,		653,		705,		776,		834,		894,		944,		39,		113,		179,		249,		303,		367,		419,		479,		545,		616,		680,		741,		809,		865,		915,		976,		21,		92,		161,		230,		290,		354,		408,		468,		530,		606,		664,		728,		788,		850,		907,		960,		57,		130,		200,		263,		317,		379,		436,		494,		560,		633,		691,		757,		825,		878,		934,		990,		12,		79,		150,		220,		282,		345,		398,		459,		521,		596,		658,		719,		782,		844,		898,		953,		48,		121,		190,		257,		310,		376,		425,		487,		555,		624,		685,		749,		817,		872,		922,		985,		32,		101,		172,		236,		296,		361,		413,		472,		539,		611,		671,		738,		796,		858,		911,		964,		63,		136,		206,		269,		328,		384,		442,		503,		574,		636,		700,		766,		829,		885,		937,		995,
        1,		71,		145,		215,		276,		340,		393,		453,		511,		587,		653,		708,		777,		834,		895,		945,		40,		113,		181,		250,		303,		369,		419,		480,		545,		617,		681,		742,		810,		868,		915,		978,		21,		93,		164,		230,		290,		354,		408,		468,		534,		606,		664,		730,		788,		850,		907,		961,		60,		130,		200,		263,		320,		380,		436,		495,		562,		633,		692,		758,		826,		878,		934,		991,		13,		81,		152,		221,		284,		347,		399,		459,		522,		596,		660,		721,		782,		844,		899,		956,		50,		122,		190,		260,		310,		376,		427,		487,		556,		627,		686,		750,		818,		873,		923,		985,		33,		103,		172,		239,		296,		362,		414,		473,		539,		611,		672,		738,		800,		860,		913,		965,		63,		137,		208,		269,		331,		385,		443,		504,		575,		638,		702,		768,		829,		886,		937,		996,
        2,		71,		146,		215,		276,		342,		393,		456,		511,		588,		654,		710,		777,		837,		896,		946,		40,		114,		181,		251,		305,		370,		420,		481,		545,		617,		682,		745,		812,		868,		916,		978,		23,		95,		164,		231,		290,		354,		408,		468,		534,		608,		665,		730,		791,		851,		907,		961,		60,		131,		200,		264,		320,		380,		438,		498,		564,		633,		692,		759,		827,		878,		934,		991,		14,		82,		154,		222,		285,		347,		401,		461,		523,		598,		660,		724,		783,		845,		901,		957,		52,		122,		190,		261,		310,		377,		428,		488,		557,		628,		689,		751,		818,		873,		928,		985,		34,		104,		173,		240,		297,		363,		414,		474,		539,		613,		673,		738,		800,		861,		913,		967,		63,		137,		210,		270,		331,		386,		445,		505,		576,		639,		702,		770,		830,		887,		938,		996,
        4,		71,		148,		216,		277,		342,		394,		457,		511,		589,		655,		712,		779,		838,		896,		946,		42,		115,		183,		251,		306,		371,		422,		481,		546,		617,		682,		746,		813,		869,		918,		978,		25,		96,		164,		233,		291,		356,		409,		468,		535,		608,		665,		733,		792,		852,		908,		962,		61,		131,		201,		264,		321,		380,		438,		498,		564,		635,		693,		761,		828,		880,		935,		992,		14,		83,		154,		223,		285,		347,		401,		461,		523,		598,		661,		724,		783,		846,		902,		957,		54,		122,		192,		261,		312,		378,		429,		489,		557,		630,		689,		753,		819,		874,		929,		986,		35,		105,		173,		240,		297,		364,		415,		475,		539,		613,		673,		739,		801,		861,		914,		967,		64,		140,		210,		271,		336,		388,		448,		505,		577,		639,		703,		772,		830,		889,		939,		998,
        5,		72,		148,		217,		278,		343,		394,		457,		514,		590,		655,		713,		779,		838,		896,		947,		44,		116,		184,		251,		306,		372,		423,		484,		547,		618,		682,		746,		815,		869,		918,		982,		26,		96,		168,		233,		292,		357,		409,		469,		537,		608,		665,		733,		794,		852,		908,		962,		61,		132,		201,		264,		322,		381,		439,		499,		566,		635,		693,		762,		828,		882,		935,		992,		18,		85,		155,		223,		285,		348,		402,		463,		523,		599,		662,		725,		785,		848,		902,		957,		55,		123,		197,		261,		313,		378,		432,		491,		559,		631,		689,		754,		820,		875,		929,		987,		35,		106,		177,		242,		298,		364,		416,		477,		541,		613,		675,		740,		804,		861,		915,		968,		66,		142,		211,		272,		336,		388,		449,		506,		582,		642,		703,		772,		830,		892,		941,		998,
        9,		73,		148,		218,		278,		344,		396,		457,		515,		594,		657,		713,		779,		840,		897,		947,		44,		117,		184,		252,		306,		372,		424,		484,		548,		619,		683,		746,		815,		870,		920,		983,		26,		97,		170,		235,		293,		357,		410,		469,		538,		608,		666,		734,		794,		853,		909,		963,		62,		133,		202,		267,		323,		381,		439,		500,		572,		635,		693,		762,		828,		885,		935,		992,		19,		85,		156,		225,		286,		348,		402,		464,		527,		600,		662,		727,		786,		848,		903,		959,		56,		126,		198,		261,		314,		378,		434,		492,		559,		631,		689,		755,		822,		875,		932,		987,		36,		107,		177,		242,		300,		365,		416,		478,		542,		615,		677,		740,		805,		862,		915,		970,		66,		142,		212,		274,		336,		390,		451,		506,		582,		643,		704,		773,		831,		892,		941,		999,
        9,		75,		149,		219,		280,		344,		397,		458,		515,		594,		657,		715,		781,		840,		898,		947,		45,		117,		186,		254,		307,		373,		424,		486,		548,		619,		684,		748,		816,		871,		921,		983,		27,		99,		170,		235,		294,		357,		410,		470,		538,		610,		668,		737,		795,		856,		911,		963,		62,		133,		202,		267,		324,		382,		440,		502,		573,		636,		698,		764,		828,		885,		935,		993,		19,		85,		159,		227,		286,		350,		403,		466,		527,		600,		663,		727,		787,		849,		905,		959,		57,		126,		199,		262,		316,		379,		435,		492,		560,		632,		690,		755,		824,		876,		933,		987,		37,		108,		178,		243,		302,		365,		416,		478,		542,		616,		678,		741,		805,		863,		915,		971,		68,		143,		213,		275,		336,		391,		451,		508,		584,		650,		704,		775,		832,		893,		943,		999,		};

TEST(TransposedIndex, FastLanesCompat64) {
    using namespace arcticdb;
    std::vector<uint64_t> transposed(1024);
    for(auto i = 0U; i < 1024U; ++i)
        transposed[i] = untransposed_arr_ow64[transposed_index(i)];

    for(auto i = 0U; i < 1024U; ++i) {
        ASSERT_EQ(transposed[i], transposed_arr_ow64[i]);
    }
}

const uint16_t untransposed_arr_ow16[1024] =
    {1,2,5,6,8,9,11,13,14,15,16,16,16,17,17,17,18,20,20,20,21,21,22,24,24,25,25,25,26,26,27,27,28,28,28,31,31,32,33,33,34,34,34,35,36,38,39,39,40,40,40,41,42,43,44,44,45,46,47,48,49,50,51,53,55,56,56,57,57,58,59,62,62,62,63,64,65,66,66,67,68,68,69,69,70,72,73,73,73,73,74,74,74,75,77,77,78,79,80,82,82,83,85,85,88,88,88,89,89,89,89,90,91,91,91,93,93,93,94,95,95,96,98,98,99,99,101,101,102,102,106,106,106,108,108,109,110,111,113,115,115,119,119,121,121,122,122,124,125,127,128,129,129,133,133,134,135,136,136,136,138,138,139,140,140,141,141,143,143,143,146,147,148,149,149,150,150,152,152,153,153,154,155,155,158,158,159,162,162,163,163,163,163,165,165,166,168,168,168,169,169,169,169,170,170,171,172,175,176,176,177,178,178,178,179,179,181,182,183,184,185,185,186,190,190,191,198,198,199,199,200,201,201,202,202,203,203,203,205,205,206,207,207,208,208,211,211,211,212,213,213,214,215,215,218,220,221,222,224,225,225,226,228,228,228,229,229,229,231,233,234,235,235,236,239,239,240,240,242,242,243,248,249,249,249,250,250,250,251,255,256,257,259,259,261,261,263,264,265,265,266,266,268,272,273,273,273,274,274,276,276,280,281,283,283,285,287,287,288,289,289,289,290,293,294,295,295,295,296,297,298,298,299,299,300,301,301,301,303,304,306,306,311,311,311,315,315,318,318,319,319,321,322,323,324,324,326,326,327,327,327,329,330,331,332,333,334,337,340,344,345,347,347,348,348,349,349,349,354,356,358,359,360,360,360,360,360,361,362,362,362,363,365,365,365,365,366,367,369,370,375,375,376,377,379,379,380,380,381,382,382,383,383,385,385,386,387,388,388,388,389,392,393,393,393,395,397,397,397,399,399,399,400,400,401,402,405,405,405,408,408,410,411,412,413,413,413,414,414,415,416,417,417,418,418,420,421,422,423,424,425,425,425,426,429,429,430,432,432,432,434,434,436,438,439,440,441,441,441,442,443,443,443,443,444,444,445,446,446,446,447,448,451,451,452,452,455,455,457,457,461,461,462,463,464,466,466,467,468,468,468,469,470,471,471,473,475,475,477,478,478,480,484,484,485,486,487,488,489,492,493,494,496,499,502,502,505,505,506,508,508,508,510,510,511,511,511,511,513,513,514,518,518,519,519,520,521,522,523,523,526,526,528,528,528,529,532,532,534,536,536,538,540,540,541,542,543,543,543,543,547,549,549,552,552,552,553,553,554,555,556,557,558,559,559,560,562,564,564,565,565,566,566,567,568,569,569,569,569,570,571,573,573,574,574,574,575,579,579,582,583,584,584,584,587,588,588,589,589,589,590,592,592,593,594,594,595,595,597,597,598,600,600,602,602,603,605,605,606,608,609,610,613,615,618,619,619,620,620,621,622,622,623,624,625,626,627,627,629,630,630,632,633,633,634,638,639,640,641,643,646,647,647,648,648,648,649,649,649,651,651,651,653,653,656,656,657,658,658,658,658,661,661,663,663,663,664,666,668,669,669,671,672,673,674,674,675,676,676,676,677,677,677,679,680,681,682,682,683,684,684,685,685,687,687,688,688,689,690,690,691,694,694,695,696,697,699,703,704,705,705,705,707,709,709,711,712,712,714,715,715,716,716,717,718,720,721,722,724,724,724,724,724,725,726,727,728,728,728,729,729,729,731,731,731,733,736,736,736,737,739,739,739,740,740,742,742,742,743,743,744,745,747,748,748,749,751,754,754,755,756,757,757,758,760,760,762,762,762,763,764,765,766,768,769,769,770,771,772,772,773,775,775,778,779,781,782,782,783,784,785,786,786,787,790,792,792,792,792,794,794,800,802,802,802,802,804,810,813,813,814,815,817,819,819,819,820,822,822,824,824,825,828,829,829,830,831,832,833,833,834,837,838,840,841,843,844,844,844,846,849,849,849,851,853,857,862,862,863,864,865,865,866,866,867,868,869,871,871,871,873,873,875,876,877,877,881,881,886,886,887,889,889,891,892,894,894,895,895,896,896,899,899,900,904,904,906,906,906,906,908,910,913,914,914,915,916,916,917,918,920,921,922,922,924,924,926,928,929,930,930,935,938,938,938,940,941,942,944,945,946,948,949,949,949,950,951,952,954,954,954,955,955,958,958,960,963,963,966,967,968,970,970,971,974,974,976,977,980,983,983,984,984,985,987,988,988,989,989,989,992,993,994,994,995,995,995,997,997,998,998,998,999,999,};

const uint16_t transposed_arr_ow16[1024] =
    //	0		1		2		3		4		5		6		7		8		9		10		11		12		13		14		15		16		17		18		19		20		21		22		23		24		25		26		27		28		29		30		31		32		33		34		35		36		37		38		39		40		41		42		43		44		45		46		47		48		49		50		51		52		53		54		55		56		57		58		59		60		61		62		63		64		65		66		67		68		69		70		71		72		73		74		75		76		77		78		79		80		81		82		83		84		85		86		87		88		89		90		91		92		93		94		95		96		97		98		99		100		101		102		103		104		105		106		107		108		109		110		111		112		113		114		115		116		117		118		119		120		121		122		123		124		125		126		127
    {
        1,		55,		102,		163,		221,		289,		360,		414,		470,		543,		598,		663,		724,		775,		862,		930,		28,		78,		138,		190,		251,		322,		387,		443,		511,		569,		633,		688,		744,		819,		895,		970,		18,		68,		121,		176,		235,		301,		375,		429,		489,		558,		619,		677,		731,		792,		875,		951,		40,		91,		150,		206,		273,		340,		400,		455,		526,		587,		649,		707,		762,		834,		914,		989,		14,		62,		110,		169,		228,		296,		365,		421,		478,		552,		606,		672,		728,		785,		867,		944,		34,		88,		143,		201,		263,		327,		393,		446,		518,		575,		646,		696,		754,		828,		906,		983,		24,		73,		129,		181,		243,		311,		381,		436,		505,		565,		625,		683,		739,		804,		887,		958,		45,		95,		158,		212,		281,		349,		408,		464,		534,		592,		657,		715,		769,		844,		922,		995,
        2,		56,		102,		165,		222,		289,		360,		415,		471,		543,		600,		663,		724,		778,		862,		935,		28,		79,		138,		191,		255,		323,		388,		443,		511,		570,		633,		689,		745,		819,		896,		971,		20,		68,		122,		176,		236,		301,		375,		429,		492,		559,		620,		677,		733,		794,		876,		952,		40,		91,		152,		207,		273,		344,		400,		455,		526,		588,		651,		709,		762,		837,		915,		989,		15,		62,		111,		169,		229,		297,		365,		422,		480,		552,		608,		673,		728,		786,		868,		945,		34,		88,		143,		202,		264,		329,		395,		446,		519,		579,		647,		697,		755,		829,		906,		984,		25,		73,		133,		182,		248,		315,		382,		438,		505,		566,		626,		684,		740,		810,		889,		960,		46,		96,		158,		213,		283,		349,		410,		466,		536,		593,		658,		716,		769,		846,		922,		997,
        5,		56,		106,		165,		224,		290,		360,		416,		471,		543,		600,		664,		724,		779,		863,		938,		28,		80,		139,		198,		256,		324,		388,		443,		511,		571,		634,		690,		747,		820,		896,		974,		20,		69,		122,		177,		239,		303,		376,		430,		493,		559,		620,		677,		736,		794,		877,		954,		40,		91,		152,		207,		273,		345,		401,		457,		528,		588,		651,		709,		762,		838,		916,		992,		16,		63,		113,		169,		229,		298,		365,		423,		484,		553,		609,		674,		728,		786,		869,		946,		34,		88,		146,		202,		265,		330,		397,		447,		519,		579,		647,		699,		756,		829,		906,		984,		25,		74,		133,		183,		249,		315,		382,		439,		506,		566,		627,		684,		740,		813,		889,		963,		47,		98,		159,		213,		283,		354,		411,		466,		536,		594,		658,		716,		770,		849,		924,		997,
        6,		57,		106,		166,		225,		293,		361,		417,		473,		543,		602,		666,		724,		781,		864,		938,		31,		82,		140,		198,		257,		324,		388,		443,		511,		573,		638,		690,		748,		822,		899,		974,		20,		69,		124,		178,		239,		304,		377,		432,		494,		560,		621,		679,		736,		800,		877,		954,		41,		93,		153,		208,		274,		347,		402,		457,		528,		589,		651,		711,		763,		840,		916,		993,		16,		64,		115,		170,		229,		298,		365,		424,		484,		553,		610,		674,		729,		787,		871,		948,		35,		89,		147,		203,		265,		331,		397,		448,		520,		582,		648,		703,		757,		830,		906,		985,		25,		74,		134,		184,		249,		318,		383,		440,		508,		567,		627,		685,		742,		813,		891,		963,		48,		98,		162,		214,		285,		356,		412,		467,		538,		594,		658,		717,		771,		849,		924,		998,
        8,		57,		106,		168,		225,		294,		362,		417,		475,		547,		602,		668,		724,		782,		865,		938,		31,		82,		140,		199,		259,		326,		389,		444,		513,		573,		639,		691,		748,		822,		899,		976,		21,		70,		125,		178,		240,		306,		379,		432,		496,		562,		622,		680,		736,		802,		881,		954,		42,		93,		153,		208,		274,		347,		405,		461,		528,		589,		653,		712,		764,		841,		917,		994,		16,		65,		115,		170,		231,		299,		366,		425,		485,		554,		613,		675,		729,		790,		871,		949,		36,		89,		148,		203,		266,		332,		397,		451,		521,		583,		648,		704,		757,		831,		908,		987,		26,		74,		135,		185,		249,		318,		383,		441,		508,		568,		629,		685,		742,		814,		892,		966,		49,		99,		162,		215,		287,		358,		413,		468,		540,		595,		658,		718,		772,		849,		926,		998,
        9,		58,		108,		168,		226,		295,		362,		418,		475,		549,		603,		669,		725,		782,		865,		940,		32,		83,		141,		199,		259,		326,		392,		444,		513,		574,		640,		694,		749,		824,		900,		977,		21,		72,		127,		178,		240,		306,		379,		432,		499,		564,		622,		681,		737,		802,		881,		955,		43,		93,		154,		211,		276,		348,		405,		461,		529,		589,		653,		712,		765,		843,		918,		994,		17,		66,		119,		171,		233,		299,		367,		425,		486,		555,		615,		676,		729,		792,		871,		949,		38,		89,		149,		203,		266,		333,		399,		451,		522,		584,		648,		705,		758,		832,		910,		988,		26,		75,		136,		185,		250,		319,		385,		441,		508,		569,		630,		687,		742,		815,		894,		967,		50,		99,		163,		215,		287,		359,		413,		468,		540,		595,		661,		720,		772,		851,		928,		998,
        11,		59,		108,		168,		228,		295,		362,		418,		477,		549,		605,		669,		726,		783,		866,		941,		33,		85,		141,		200,		261,		327,		393,		445,		514,		574,		641,		694,		751,		824,		904,		980,		22,		73,		128,		179,		242,		311,		380,		434,		502,		564,		623,		682,		739,		802,		886,		955,		44,		94,		155,		211,		276,		348,		405,		462,		532,		590,		656,		714,		766,		844,		920,		995,		17,		66,		119,		172,		234,		300,		369,		425,		487,		556,		618,		676,		731,		792,		873,		949,		39,		89,		149,		205,		268,		334,		399,		452,		523,		584,		649,		705,		760,		833,		913,		988,		27,		77,		136,		186,		250,		319,		385,		441,		510,		569,		630,		687,		743,		817,		894,		968,		51,		101,		163,		218,		288,		360,		413,		468,		541,		597,		661,		721,		773,		853,		929,		999,
        13,		62,		109,		169,		228,		295,		363,		420,		478,		552,		605,		671,		727,		784,		866,		942,		33,		85,		143,		201,		261,		327,		393,		446,		518,		574,		643,		695,		754,		825,		904,		983,		24,		73,		129,		179,		242,		311,		380,		434,		502,		565,		624,		682,		739,		802,		886,		958,		44,		95,		155,		211,		280,		349,		408,		463,		532,		592,		656,		715,		768,		844,		921,		995,		17,		67,		121,		175,		235,		301,		370,		426,		488,		557,		619,		676,		731,		792,		873,		950,		39,		90,		150,		205,		272,		337,		399,		452,		523,		584,		649,		705,		760,		833,		914,		989,		27,		77,		136,		190,		250,		321,		386,		442,		510,		569,		632,		688,		743,		819,		895,		970,		53,		101,		163,		220,		289,		360,		414,		469,		542,		597,		663,		722,		775,		857,		930,		999,		};


TEST(TransposedIndex, FastLanesCompat16) {
    using namespace arcticdb;
    std::vector<uint16_t> transposed(1024);
    for(auto i = 0U; i < 1024U; ++i)
        transposed[i] = untransposed_arr_ow16[transposed_index(i)];

    for(auto i = 0U; i < 1024U; ++i) {
        ASSERT_EQ(transposed[i], transposed_arr_ow16[i]);
    }
}

TEST(Untranspose, FastLanesCompat64) {
    using namespace arcticdb;
    std::vector<uint64_t> untransposed(1024);

    untranspose<uint64_t>(transposed_arr_ow64, untransposed.data());

    for(auto i = 0U; i < 1024U; ++i) {
        if(untransposed[i] != untransposed_arr_ow64[i])
            log::version().info("poops");

        ASSERT_EQ(untransposed[i], untransposed_arr_ow64[i]);
    }
}